syntax = "proto3";

package spine.tools.protoc;

import "spine/options.proto";

option (type_url_prefix) = "type.spine.io";
option java_package = "io.spine.tools.protoc";
option java_outer_classname = "ConfigProto";
option java_multiple_files = true;

option (internal_all) = true;

// Interface to mark UUID messages.
//
// An empty value signifies that the messages should not be marked.
//
message UuidInterface {

    string interface_name = 1;
}

// Interface to mark messages defined in a file with a certain name postfix.
//
message GeneratedInterface {

    string interface_name = 1;

    string file_postfix = 2 [(required) = true];
}

// Interface to mark Enrichment messages.
//
// An empty value signifies that the messages should not be marked.
//
message EnrichmentInterface {

    string interface_name = 1;
}

// Method generator that generates additional methods for a message with a certain option.
//
// An empty value signifies that the additional accessor methods should not be generated.
//
message GeneratedMethod {

    // A fully-qualified name of the message factory class.
    string factory_name = 1;

    // A filter that defines for which message types the method generator should be used.
    TypeFilter filter = 2;
}

// Types filter applied to generated code configurations.
//
message TypeFilter {

    option (required_field) = "file_postfix|option_name";

    oneof value {

        // An ending that a .proto file name should have.
        //
        // If a .proto file matches current ending, to all its messages some code generation
        // will be applied.
        //
        string file_postfix = 1;

        // A name of a message option that the message should have.
        //
        // If a message has a particular option some code generation will be applied to the message.
        //
        string option_name = 2;
    }
}

// Configuration of the Spine Protoc plugin.
//
// The configuration is passed to the plugin as the single option. The passed value is serialized
// and base-64 encoded.
//
message SpineProtocConfig {

    UuidInterface uuid_interface = 1;

    repeated GeneratedInterface generated_interface = 2;

    EnrichmentInterface enrichment_interface = 3;

    repeated GeneratedMethod generated_method = 4;
}
